{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { obtainSlot } from '../utils';\nexport function decorator(key, option) {\n  return function (proto, name) {\n    const slot = obtainSlot(proto);\n    const map = slot.obtainMap('watch');\n    const opt = Object.assign({}, option !== null && option !== void 0 ? option : {}, {\n      key: key,\n      handler: proto[name]\n    });\n    if (map.has(name)) {\n      const t = map.get(name);\n      if (Array.isArray(t)) {\n        t.push(opt);\n      } else {\n        map.set(name, [t, opt]);\n      }\n    } else {\n      map.set(name, opt);\n    }\n  };\n}\nexport function build(cons, optionBuilder) {\n  var _a;\n  (_a = optionBuilder.watch) !== null && _a !== void 0 ? _a : optionBuilder.watch = {};\n  const slot = obtainSlot(cons.prototype);\n  const names = slot.obtainMap('watch');\n  if (names) {\n    names.forEach((value, _name) => {\n      const values = Array.isArray(value) ? value : [value];\n      values.forEach(v => {\n        if (!optionBuilder.watch[v.key]) {\n          optionBuilder.watch[v.key] = v;\n        } else {\n          const t = optionBuilder.watch[v.key];\n          if (Array.isArray(t)) {\n            t.push(v);\n          } else {\n            optionBuilder.watch[v.key] = [t, v];\n          }\n        }\n      });\n    });\n  }\n}","map":{"version":3,"names":["obtainSlot","decorator","key","option","proto","name","slot","map","obtainMap","opt","Object","assign","handler","has","t","get","Array","isArray","push","set","build","cons","optionBuilder","_a","watch","prototype","names","forEach","value","_name","values","v"],"sources":["../../../src/option/watch.ts"],"sourcesContent":[null],"mappings":";AAEA,SAASA,UAAU,QAAS,UAAU;AAWtC,OAAM,SAAUC,SAASA,CAACC,GAAW,EAAEC,MAAe;EAClD,OAAO,UAAUC,KAAU,EAAEC,IAAY;IACrC,MAAMC,IAAI,GAAGN,UAAU,CAACI,KAAK,CAAC;IAC9B,MAAMG,GAAG,GAAGD,IAAI,CAACE,SAAS,CAAC,OAAO,CAAC;IACnC,MAAMC,GAAG,GAAGC,MAAM,CAACC,MAAM,CAAC,EAAE,EAAER,MAAM,aAANA,MAAM,cAANA,MAAM,GAAI,EAAE,EAAE;MACxCD,GAAG,EAAEA,GAAG;MACRU,OAAO,EAAER,KAAK,CAACC,IAAI;KACtB,CAAC;IACF,IAAIE,GAAG,CAACM,GAAG,CAACR,IAAI,CAAC,EAAE;MACf,MAAMS,CAAC,GAAGP,GAAG,CAACQ,GAAG,CAACV,IAAI,CAAE;MACxB,IAAIW,KAAK,CAACC,OAAO,CAACH,CAAC,CAAC,EAAE;QAClBA,CAAC,CAACI,IAAI,CAACT,GAAG,CAAC;OACd,MAAM;QACHF,GAAG,CAACY,GAAG,CAACd,IAAI,EAAE,CAACS,CAAC,EAAEL,GAAG,CAAC,CAAC;;KAE9B,MACI;MACDF,GAAG,CAACY,GAAG,CAACd,IAAI,EAAEI,GAAG,CAAC;;EAE1B,CAAC;AACL;AAEA,OAAM,SAAUW,KAAKA,CAACC,IAAU,EAAEC,aAA4B;;EAC1D,CAAAC,EAAA,GAAAD,aAAa,CAACE,KAAK,cAAAD,EAAA,cAAAA,EAAA,GAAnBD,aAAa,CAACE,KAAK,GAAK,EAAE;EAC1B,MAAMlB,IAAI,GAAGN,UAAU,CAACqB,IAAI,CAACI,SAAS,CAAC;EACvC,MAAMC,KAAK,GAAGpB,IAAI,CAACE,SAAS,CAAC,OAAO,CAAC;EACrC,IAAIkB,KAAK,EAAE;IACPA,KAAK,CAACC,OAAO,CAAC,CAACC,KAAK,EAAEC,KAAK,KAAI;MAC3B,MAAMC,MAAM,GAAGd,KAAK,CAACC,OAAO,CAACW,KAAK,CAAC,GAAGA,KAAK,GAAG,CAACA,KAAK,CAAC;MACrDE,MAAM,CAACH,OAAO,CAACI,CAAC,IAAG;QACf,IAAI,CAACT,aAAa,CAACE,KAAM,CAACO,CAAC,CAAC7B,GAAG,CAAC,EAAE;UAC9BoB,aAAa,CAACE,KAAM,CAACO,CAAC,CAAC7B,GAAG,CAAC,GAAG6B,CAAC;SAClC,MAAM;UACH,MAAMjB,CAAC,GAAGQ,aAAa,CAACE,KAAM,CAACO,CAAC,CAAC7B,GAAG,CAAC;UACrC,IAAIc,KAAK,CAACC,OAAO,CAACH,CAAC,CAAC,EAAE;YAClBA,CAAC,CAACI,IAAI,CAACa,CAAC,CAAC;WACZ,MAAM;YACHT,aAAa,CAACE,KAAM,CAACO,CAAC,CAAC7B,GAAG,CAAC,GAAG,CAACY,CAAC,EAAEiB,CAAC,CAAC;;;MAGhD,CAAC,CAAC;IACN,CAAC,CAAC;;AAGV"},"metadata":{},"sourceType":"module","externalDependencies":[]}