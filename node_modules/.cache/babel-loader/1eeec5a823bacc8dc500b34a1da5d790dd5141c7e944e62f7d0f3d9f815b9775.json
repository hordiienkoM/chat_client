{"ast":null,"code":"import { obtainSlot, toComponentReverse, excludeNames, getValidNames, optoinNullableMemberDecorator } from '../utils';\nexport const HookNames = [\"beforeCreate\", \"created\", \"beforeMount\", \"mounted\", \"beforeUpdate\", \"updated\", \"activated\", \"deactivated\", \"beforeDestroy\", \"beforeUnmount\", \"destroyed\", \"unmounted\", \"renderTracked\", \"renderTriggered\", \"errorCaptured\", \"serverPrefetch\", \"render\"];\nexport const decorator = optoinNullableMemberDecorator(function (proto, name) {\n  const slot = obtainSlot(proto);\n  const map = slot.obtainMap('hooks');\n  map.set(name, null);\n});\nexport function build(cons, optionBuilder) {\n  var _a, _b;\n  const slot = obtainSlot(cons.prototype);\n  const protoArr = toComponentReverse(cons.prototype);\n  const map = slot.obtainMap('hooks');\n  (_a = optionBuilder.hooks) !== null && _a !== void 0 ? _a : optionBuilder.hooks = {};\n  (_b = optionBuilder.methods) !== null && _b !== void 0 ? _b : optionBuilder.methods = {};\n  const HookFunctions = {};\n  const MethodFunctions = {};\n  protoArr.forEach(proto => {\n    excludeNames(getValidNames(proto, (des, name) => {\n      if (name === 'constructor') {\n        return false;\n      }\n      if (typeof des.value === 'function') {\n        return true;\n      }\n      return false;\n    }), slot).forEach(name => {\n      if (HookNames.includes(name) || map.has(name)) {\n        HookFunctions[name] = proto[name];\n      } else {\n        MethodFunctions[name] = proto[name];\n      }\n    });\n  });\n  Object.assign(optionBuilder.methods, MethodFunctions);\n  const bccbs = optionBuilder.beforeCreateCallbacks;\n  if (bccbs && bccbs.length > 0) {\n    const oldBc = HookFunctions['beforeCreate'];\n    HookFunctions['beforeCreate'] = function () {\n      bccbs.forEach(bccb => bccb.apply(this, arguments));\n      if (oldBc) {\n        oldBc.apply(this, arguments);\n      }\n    };\n  }\n  Object.assign(optionBuilder.hooks, HookFunctions);\n}","map":{"version":3,"names":["obtainSlot","toComponentReverse","excludeNames","getValidNames","optoinNullableMemberDecorator","HookNames","decorator","proto","name","slot","map","obtainMap","set","build","cons","optionBuilder","prototype","protoArr","_a","hooks","_b","methods","HookFunctions","MethodFunctions","forEach","des","value","includes","has","Object","assign","bccbs","beforeCreateCallbacks","length","oldBc","bccb","apply","arguments"],"sources":["../../../src/option/methodsAndHooks.ts"],"sourcesContent":[null],"mappings":"AAEA,SAASA,UAAU,EAAEC,kBAAkB,EAAEC,YAAY,EAAEC,aAAa,EAAEC,6BAA6B,QAAQ,UAAU;AAErH,OAAO,MAAMC,SAAS,GAAG,CACrB,cAAc,EACd,SAAS,EACT,aAAa,EACb,SAAS,EACT,cAAc,EACd,SAAS,EACT,WAAW,EACX,aAAa,EACb,eAAe,EACf,eAAe,EACf,WAAW,EACX,WAAW,EACX,eAAe,EACf,iBAAiB,EACjB,eAAe,EACf,gBAAgB,EAChB,QAAQ,CACF;AAGV,OAAO,MAAMC,SAAS,GAAGF,6BAA6B,CAAC,UAAUG,KAAU,EAAEC,IAAY;EACrF,MAAMC,IAAI,GAAGT,UAAU,CAACO,KAAK,CAAC;EAC9B,MAAMG,GAAG,GAAGD,IAAI,CAACE,SAAS,CAAC,OAAO,CAAC;EACnCD,GAAG,CAACE,GAAG,CAACJ,IAAI,EAAE,IAAI,CAAC;AACvB,CAAC,CAAC;AAGF,OAAM,SAAUK,KAAKA,CAACC,IAAU,EAAEC,aAA4B;;EAC1D,MAAMN,IAAI,GAAGT,UAAU,CAACc,IAAI,CAACE,SAAS,CAAC;EACvC,MAAMC,QAAQ,GAAGhB,kBAAkB,CAACa,IAAI,CAACE,SAAS,CAAC;EACnD,MAAMN,GAAG,GAAGD,IAAI,CAACE,SAAS,CAAC,OAAO,CAAC;EAEnC,CAAAO,EAAA,GAAAH,aAAa,CAACI,KAAK,cAAAD,EAAA,cAAAA,EAAA,GAAnBH,aAAa,CAACI,KAAK,GAAK,EAAE;EAC1B,CAAAC,EAAA,GAAAL,aAAa,CAACM,OAAO,cAAAD,EAAA,cAAAA,EAAA,GAArBL,aAAa,CAACM,OAAO,GAAK,EAAE;EAC5B,MAAMC,aAAa,GAA6B,EAAE;EAClD,MAAMC,eAAe,GAA6B,EAAE;EACpDN,QAAQ,CAACO,OAAO,CAACjB,KAAK,IAAG;IACrBL,YAAY,CAACC,aAAa,CAACI,KAAK,EAAE,CAACkB,GAAG,EAAEjB,IAAI,KAAI;MAE5C,IAAIA,IAAI,KAAK,aAAa,EAAE;QACxB,OAAO,KAAK;;MAEhB,IAAI,OAAOiB,GAAG,CAACC,KAAK,KAAK,UAAU,EAAE;QAEjC,OAAO,IAAI;;MAEf,OAAO,KAAK;IAChB,CAAC,CAAC,EAAEjB,IAAI,CAAC,CAACe,OAAO,CAAChB,IAAI,IAAG;MACrB,IAAIH,SAAS,CAACsB,QAAQ,CAACnB,IAAW,CAAC,IAAIE,GAAG,CAACkB,GAAG,CAACpB,IAAI,CAAC,EAAE;QAElDc,aAAa,CAACd,IAAI,CAAC,GAAGD,KAAK,CAACC,IAAI,CAAC;OACpC,MACI;QACDe,eAAe,CAACf,IAAI,CAAC,GAAGD,KAAK,CAACC,IAAI,CAAC;;IAE3C,CAAC,CAAC;EAGN,CAAC,CAAC;EAEFqB,MAAM,CAACC,MAAM,CAACf,aAAa,CAACM,OAAO,EAAEE,eAAe,CAAC;EACrD,MAAMQ,KAAK,GAAGhB,aAAa,CAACiB,qBAAqB;EACjD,IAAID,KAAK,IAAIA,KAAK,CAACE,MAAM,GAAG,CAAC,EAAE;IAC3B,MAAMC,KAAK,GAAGZ,aAAa,CAAC,cAAc,CAAC;IAC3CA,aAAa,CAAC,cAAc,CAAC,GAAG;MAC5BS,KAAK,CAACP,OAAO,CAACW,IAAI,IAAIA,IAAI,CAACC,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC,CAAC;MAClD,IAAIH,KAAK,EAAE;QACPA,KAAK,CAACE,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;;IAEpC,CAAC;;EAELR,MAAM,CAACC,MAAM,CAACf,aAAa,CAACI,KAAK,EAAEG,aAAa,CAAC;AAErD"},"metadata":{},"sourceType":"module","externalDependencies":[]}