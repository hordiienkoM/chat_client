{"ast":null,"code":"import { Base } from './index';\nconst SlotSymbol = Symbol('vue-facing-decorator-slot');\nclass Slot {\n  constructor(master) {\n    this.names = new Map();\n    this.inComponent = false;\n    this.cachedVueComponent = null;\n    this.master = master;\n  }\n  obtainMap(name) {\n    let map = this.names.get(name);\n    if (!map) {\n      map = new Map();\n      this.names.set(name, map);\n    }\n    return map;\n  }\n}\nexport function makeSlot(obj) {\n  if (getSlot(obj)) {\n    throw '';\n  }\n  const slot = new Slot(obj);\n  Object.defineProperty(obj, SlotSymbol, {\n    enumerable: false,\n    value: slot\n  });\n  return slot;\n}\nexport function getSlot(obj) {\n  var _a;\n  return (_a = Object.getOwnPropertyDescriptor(obj, SlotSymbol)) === null || _a === void 0 ? void 0 : _a.value;\n}\nexport function obtainSlot(obj) {\n  const slot = getSlot(obj);\n  if (slot) {\n    return slot;\n  }\n  return makeSlot(obj);\n}\nexport function makeObject(names, obj) {\n  return names.reduce((pv, cv) => {\n    pv[cv] = obj[cv];\n    return pv;\n  }, {});\n}\n// export function toBaseReverse(obj: any) {\n//     const arr: any[] = []\n//     let curr = obj\n//     while (curr.constructor !== Base) {\n//         arr.unshift(curr)\n//         curr = Object.getPrototypeOf(curr)\n//     }\n//     return arr\n// }\nexport function toComponentReverse(obj) {\n  const arr = [];\n  let curr = obj;\n  do {\n    arr.unshift(curr);\n    curr = Object.getPrototypeOf(curr);\n  } while (curr.constructor !== Base && !getSlot(curr));\n  return arr;\n}\nexport function getSuperSlot(obj) {\n  let curr = Object.getPrototypeOf(obj);\n  while (curr.constructor !== Base) {\n    const slot = getSlot(curr);\n    if (slot) {\n      return slot;\n    }\n    curr = Object.getPrototypeOf(curr);\n  }\n  return null;\n}\n// export function extendSlotPath(obj: any): {\n//     constructor: any\n// }[] {\n//     const arr: any[] = []\n//     let curr = obj\n//     while (curr.constructor !== Base) {\n//         if (getSlot(curr)) {\n//             arr.push(curr)\n//         }\n//         curr = Object.getPrototypeOf(curr)\n//     }\n//     return arr\n// }\n// export function \n// export function collect<>(slot: Slot,mapName:keyof SlotMapTypes,) {\n//     let currSlot: Slot | null = slot\n//     while (currSlot != null) {\n//         for (const mapName of currSlot.names.keys()) {\n//             if (['watch', 'hooks', 'setup'].includes(mapName)) {\n//                 continue\n//             }\n//             const map = currSlot.names.get(mapName)!\n//             if (map.has(name)) {\n//                 return false\n//             }\n//         }\n//         currSlot = getSuperSlot(currSlot.master)\n//     }\n//     return true\n// }\nexport function excludeNames(names, slot) {\n  return names.filter(name => {\n    let currSlot = slot;\n    while (currSlot != null) {\n      for (const mapName of currSlot.names.keys()) {\n        if (['watch', 'hooks', 'setup', 'emits'].includes(mapName)) {\n          continue;\n        }\n        const map = currSlot.names.get(mapName);\n        if (map.has(name)) {\n          return false;\n        }\n      }\n      currSlot = getSuperSlot(currSlot.master);\n    }\n    return true;\n  });\n}\nexport function getValidNames(obj, filter) {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  return Object.keys(descriptors).filter(name => filter(descriptors[name], name));\n}\nexport function optoinNullableMemberDecorator(handler) {\n  function decorator(optionOrProto, name) {\n    if (name) {\n      handler(optionOrProto, name);\n    } else {\n      return function (proto, name) {\n        handler(proto, name, optionOrProto);\n      };\n    }\n  }\n  return decorator;\n}","map":{"version":3,"names":["Base","SlotSymbol","Symbol","Slot","constructor","master","names","Map","inComponent","cachedVueComponent","obtainMap","name","map","get","set","makeSlot","obj","getSlot","slot","Object","defineProperty","enumerable","value","_a","getOwnPropertyDescriptor","obtainSlot","makeObject","reduce","pv","cv","toComponentReverse","arr","curr","unshift","getPrototypeOf","getSuperSlot","excludeNames","filter","currSlot","mapName","keys","includes","has","getValidNames","descriptors","getOwnPropertyDescriptors","optoinNullableMemberDecorator","handler","decorator","optionOrProto","proto"],"sources":["../../src/utils.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}