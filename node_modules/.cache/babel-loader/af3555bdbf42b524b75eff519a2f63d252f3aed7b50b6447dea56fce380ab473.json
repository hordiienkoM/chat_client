{"ast":null,"code":"\"use strict\";\n\n/*\n * Copyright 2021-2022 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nrequire(\"core-js/modules/es.regexp.flags.js\");\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __values = this && this.__values || function (o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator,\n    m = s && o[s],\n    i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n    next: function () {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RequestChannelResponderStream = exports.RequestChannelRequesterStream = void 0;\nvar Errors_1 = require(\"./Errors\");\nvar Fragmenter_1 = require(\"./Fragmenter\");\nvar Frames_1 = require(\"./Frames\");\nvar Reassembler = __importStar(require(\"./Reassembler\"));\nvar RequestChannelRequesterStream = /** @class */function () {\n  function RequestChannelRequesterStream(payload, isComplete, receiver, fragmentSize, initialRequestN, leaseManager) {\n    this.payload = payload;\n    this.isComplete = isComplete;\n    this.receiver = receiver;\n    this.fragmentSize = fragmentSize;\n    this.initialRequestN = initialRequestN;\n    this.leaseManager = leaseManager;\n    this.streamType = Frames_1.FrameTypes.REQUEST_CHANNEL;\n    // TODO: add payload size validation\n  }\n\n  RequestChannelRequesterStream.prototype.handleReady = function (streamId, stream) {\n    var e_1, _a;\n    if (this.outboundDone) {\n      return false;\n    }\n    this.streamId = streamId;\n    this.stream = stream;\n    stream.connect(this);\n    var isCompleted = this.isComplete;\n    if (isCompleted) {\n      this.outboundDone = isCompleted;\n    }\n    if ((0, Fragmenter_1.isFragmentable)(this.payload, this.fragmentSize, Frames_1.FrameTypes.REQUEST_CHANNEL)) {\n      try {\n        for (var _b = __values((0, Fragmenter_1.fragmentWithRequestN)(streamId, this.payload, this.fragmentSize, Frames_1.FrameTypes.REQUEST_CHANNEL, this.initialRequestN, isCompleted)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var frame = _c.value;\n          this.stream.send(frame);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    } else {\n      this.stream.send({\n        type: Frames_1.FrameTypes.REQUEST_CHANNEL,\n        data: this.payload.data,\n        metadata: this.payload.metadata,\n        requestN: this.initialRequestN,\n        flags: (this.payload.metadata !== undefined ? Frames_1.Flags.METADATA : Frames_1.Flags.NONE) | (isCompleted ? Frames_1.Flags.COMPLETE : Frames_1.Flags.NONE),\n        streamId: streamId\n      });\n    }\n    if (this.hasExtension) {\n      this.stream.send({\n        type: Frames_1.FrameTypes.EXT,\n        streamId: streamId,\n        extendedContent: this.extendedContent,\n        extendedType: this.extendedType,\n        flags: this.flags\n      });\n    }\n    return true;\n  };\n  RequestChannelRequesterStream.prototype.handleReject = function (error) {\n    if (this.inboundDone) {\n      return;\n    }\n    this.inboundDone = true;\n    this.outboundDone = true;\n    this.receiver.onError(error);\n  };\n  RequestChannelRequesterStream.prototype.handle = function (frame) {\n    var errorMessage;\n    var frameType = frame.type;\n    switch (frameType) {\n      case Frames_1.FrameTypes.PAYLOAD:\n        {\n          var hasComplete = Frames_1.Flags.hasComplete(frame.flags);\n          var hasNext = Frames_1.Flags.hasNext(frame.flags);\n          if (hasComplete || !Frames_1.Flags.hasFollows(frame.flags)) {\n            if (hasComplete) {\n              this.inboundDone = true;\n              if (this.outboundDone) {\n                this.stream.disconnect(this);\n              }\n              if (!hasNext) {\n                // TODO: add validation no frame in reassembly\n                this.receiver.onComplete();\n                return;\n              }\n            }\n            var payload = this.hasFragments ? Reassembler.reassemble(this, frame.data, frame.metadata) : {\n              data: frame.data,\n              metadata: frame.metadata\n            };\n            this.receiver.onNext(payload, hasComplete);\n            return;\n          }\n          if (Reassembler.add(this, frame.data, frame.metadata)) {\n            return;\n          }\n          errorMessage = \"Unexpected frame size\";\n          break;\n        }\n      case Frames_1.FrameTypes.CANCEL:\n        {\n          if (this.outboundDone) {\n            return;\n          }\n          this.outboundDone = true;\n          if (this.inboundDone) {\n            this.stream.disconnect(this);\n          }\n          this.receiver.cancel();\n          return;\n        }\n      case Frames_1.FrameTypes.REQUEST_N:\n        {\n          if (this.outboundDone) {\n            return;\n          }\n          if (this.hasFragments) {\n            errorMessage = \"Unexpected frame type [\".concat(frameType, \"] during reassembly\");\n            break;\n          }\n          this.receiver.request(frame.requestN);\n          return;\n        }\n      case Frames_1.FrameTypes.ERROR:\n        {\n          var outboundDone = this.outboundDone;\n          this.inboundDone = true;\n          this.outboundDone = true;\n          this.stream.disconnect(this);\n          Reassembler.cancel(this);\n          if (!outboundDone) {\n            this.receiver.cancel();\n          }\n          this.receiver.onError(new Errors_1.RSocketError(frame.code, frame.message));\n          return;\n        }\n      case Frames_1.FrameTypes.EXT:\n        this.receiver.onExtension(frame.extendedType, frame.extendedContent, Frames_1.Flags.hasIgnore(frame.flags));\n        return;\n      default:\n        {\n          errorMessage = \"Unexpected frame type [\".concat(frameType, \"]\");\n        }\n    }\n    this.close(new Errors_1.RSocketError(Errors_1.ErrorCodes.CANCELED, errorMessage));\n    this.stream.send({\n      type: Frames_1.FrameTypes.CANCEL,\n      streamId: this.streamId,\n      flags: Frames_1.Flags.NONE\n    });\n    this.stream.disconnect(this);\n  };\n  RequestChannelRequesterStream.prototype.request = function (n) {\n    if (this.inboundDone) {\n      return;\n    }\n    if (!this.streamId) {\n      this.initialRequestN += n;\n      return;\n    }\n    this.stream.send({\n      type: Frames_1.FrameTypes.REQUEST_N,\n      flags: Frames_1.Flags.NONE,\n      requestN: n,\n      streamId: this.streamId\n    });\n  };\n  RequestChannelRequesterStream.prototype.cancel = function () {\n    var _a;\n    var inboundDone = this.inboundDone;\n    var outboundDone = this.outboundDone;\n    if (inboundDone && outboundDone) {\n      return;\n    }\n    this.inboundDone = true;\n    this.outboundDone = true;\n    if (!outboundDone) {\n      this.receiver.cancel();\n    }\n    if (!this.streamId) {\n      (_a = this.leaseManager) === null || _a === void 0 ? void 0 : _a.cancelRequest(this);\n      return;\n    }\n    this.stream.send({\n      type: inboundDone ? Frames_1.FrameTypes.ERROR : Frames_1.FrameTypes.CANCEL,\n      flags: Frames_1.Flags.NONE,\n      streamId: this.streamId,\n      code: Errors_1.ErrorCodes.CANCELED,\n      message: \"Cancelled\"\n    });\n    this.stream.disconnect(this);\n    Reassembler.cancel(this);\n  };\n  RequestChannelRequesterStream.prototype.onNext = function (payload, isComplete) {\n    var e_2, _a;\n    if (this.outboundDone) {\n      return;\n    }\n    if (isComplete) {\n      this.outboundDone = true;\n      if (this.inboundDone) {\n        this.stream.disconnect(this);\n      }\n    }\n    if ((0, Fragmenter_1.isFragmentable)(payload, this.fragmentSize, Frames_1.FrameTypes.PAYLOAD)) {\n      try {\n        for (var _b = __values((0, Fragmenter_1.fragment)(this.streamId, payload, this.fragmentSize, Frames_1.FrameTypes.PAYLOAD, isComplete)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var frame = _c.value;\n          this.stream.send(frame);\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    } else {\n      this.stream.send({\n        type: Frames_1.FrameTypes.PAYLOAD,\n        streamId: this.streamId,\n        flags: Frames_1.Flags.NEXT | (payload.metadata ? Frames_1.Flags.METADATA : Frames_1.Flags.NONE) | (isComplete ? Frames_1.Flags.COMPLETE : Frames_1.Flags.NONE),\n        data: payload.data,\n        metadata: payload.metadata\n      });\n    }\n  };\n  RequestChannelRequesterStream.prototype.onComplete = function () {\n    if (!this.streamId) {\n      this.isComplete = true;\n      return;\n    }\n    if (this.outboundDone) {\n      return;\n    }\n    this.outboundDone = true;\n    this.stream.send({\n      type: Frames_1.FrameTypes.PAYLOAD,\n      streamId: this.streamId,\n      flags: Frames_1.Flags.COMPLETE,\n      data: null,\n      metadata: null\n    });\n    if (this.inboundDone) {\n      this.stream.disconnect(this);\n    }\n  };\n  RequestChannelRequesterStream.prototype.onError = function (error) {\n    if (this.outboundDone) {\n      return;\n    }\n    var inboundDone = this.inboundDone;\n    this.outboundDone = true;\n    this.inboundDone = true;\n    this.stream.send({\n      type: Frames_1.FrameTypes.ERROR,\n      streamId: this.streamId,\n      flags: Frames_1.Flags.NONE,\n      code: error instanceof Errors_1.RSocketError ? error.code : Errors_1.ErrorCodes.APPLICATION_ERROR,\n      message: error.message\n    });\n    this.stream.disconnect(this);\n    if (!inboundDone) {\n      this.receiver.onError(error);\n    }\n  };\n  RequestChannelRequesterStream.prototype.onExtension = function (extendedType, content, canBeIgnored) {\n    if (this.outboundDone) {\n      return;\n    }\n    if (!this.streamId) {\n      this.hasExtension = true;\n      this.extendedType = extendedType;\n      this.extendedContent = content;\n      this.flags = canBeIgnored ? Frames_1.Flags.IGNORE : Frames_1.Flags.NONE;\n      return;\n    }\n    this.stream.send({\n      streamId: this.streamId,\n      type: Frames_1.FrameTypes.EXT,\n      extendedType: extendedType,\n      extendedContent: content,\n      flags: canBeIgnored ? Frames_1.Flags.IGNORE : Frames_1.Flags.NONE\n    });\n  };\n  RequestChannelRequesterStream.prototype.close = function (error) {\n    if (this.inboundDone && this.outboundDone) {\n      return;\n    }\n    var inboundDone = this.inboundDone;\n    var outboundDone = this.outboundDone;\n    this.inboundDone = true;\n    this.outboundDone = true;\n    Reassembler.cancel(this);\n    if (!outboundDone) {\n      this.receiver.cancel();\n    }\n    if (!inboundDone) {\n      if (error) {\n        this.receiver.onError(error);\n      } else {\n        this.receiver.onComplete();\n      }\n    }\n  };\n  return RequestChannelRequesterStream;\n}();\nexports.RequestChannelRequesterStream = RequestChannelRequesterStream;\nvar RequestChannelResponderStream = /** @class */function () {\n  function RequestChannelResponderStream(streamId, stream, fragmentSize, handler, frame) {\n    this.streamId = streamId;\n    this.stream = stream;\n    this.fragmentSize = fragmentSize;\n    this.handler = handler;\n    this.streamType = Frames_1.FrameTypes.REQUEST_CHANNEL;\n    stream.connect(this);\n    if (Frames_1.Flags.hasFollows(frame.flags)) {\n      Reassembler.add(this, frame.data, frame.metadata);\n      this.initialRequestN = frame.requestN;\n      this.isComplete = Frames_1.Flags.hasComplete(frame.flags);\n      return;\n    }\n    var payload = {\n      data: frame.data,\n      metadata: frame.metadata\n    };\n    var hasComplete = Frames_1.Flags.hasComplete(frame.flags);\n    this.inboundDone = hasComplete;\n    try {\n      this.receiver = handler(payload, frame.requestN, hasComplete, this);\n      if (this.outboundDone && this.defferedError) {\n        this.receiver.onError(this.defferedError);\n      }\n    } catch (error) {\n      if (this.outboundDone && !this.inboundDone) {\n        this.cancel();\n      } else {\n        this.inboundDone = true;\n      }\n      this.onError(error);\n    }\n  }\n  RequestChannelResponderStream.prototype.handle = function (frame) {\n    var errorMessage;\n    var frameType = frame.type;\n    switch (frameType) {\n      case Frames_1.FrameTypes.PAYLOAD:\n        {\n          if (Frames_1.Flags.hasFollows(frame.flags)) {\n            if (Reassembler.add(this, frame.data, frame.metadata)) {\n              return;\n            }\n            errorMessage = \"Unexpected frame size\";\n            break;\n          }\n          var payload = this.hasFragments ? Reassembler.reassemble(this, frame.data, frame.metadata) : {\n            data: frame.data,\n            metadata: frame.metadata\n          };\n          var hasComplete = Frames_1.Flags.hasComplete(frame.flags);\n          if (!this.receiver) {\n            var inboundDone = this.isComplete || hasComplete;\n            if (inboundDone) {\n              this.inboundDone = true;\n              if (this.outboundDone) {\n                this.stream.disconnect(this);\n              }\n            }\n            try {\n              this.receiver = this.handler(payload, this.initialRequestN, inboundDone, this);\n              if (this.outboundDone && this.defferedError) {}\n            } catch (error) {\n              if (this.outboundDone && !this.inboundDone) {\n                this.cancel();\n              } else {\n                this.inboundDone = true;\n              }\n              this.onError(error);\n            }\n          } else {\n            if (hasComplete) {\n              this.inboundDone = true;\n              if (this.outboundDone) {\n                this.stream.disconnect(this);\n              }\n              if (!Frames_1.Flags.hasNext(frame.flags)) {\n                this.receiver.onComplete();\n                return;\n              }\n            }\n            this.receiver.onNext(payload, hasComplete);\n          }\n          return;\n        }\n      case Frames_1.FrameTypes.REQUEST_N:\n        {\n          if (!this.receiver || this.hasFragments) {\n            errorMessage = \"Unexpected frame type [\".concat(frameType, \"] during reassembly\");\n            break;\n          }\n          this.receiver.request(frame.requestN);\n          return;\n        }\n      case Frames_1.FrameTypes.ERROR:\n      case Frames_1.FrameTypes.CANCEL:\n        {\n          var inboundDone = this.inboundDone;\n          var outboundDone = this.outboundDone;\n          this.inboundDone = true;\n          this.outboundDone = true;\n          this.stream.disconnect(this);\n          Reassembler.cancel(this);\n          if (!this.receiver) {\n            return;\n          }\n          if (!outboundDone) {\n            this.receiver.cancel();\n          }\n          if (!inboundDone) {\n            var error = frameType === Frames_1.FrameTypes.CANCEL ? new Errors_1.RSocketError(Errors_1.ErrorCodes.CANCELED, \"Cancelled\") : new Errors_1.RSocketError(frame.code, frame.message);\n            this.receiver.onError(error);\n          }\n          return;\n        }\n      case Frames_1.FrameTypes.EXT:\n        {\n          if (!this.receiver || this.hasFragments) {\n            errorMessage = \"Unexpected frame type [\".concat(frameType, \"] during reassembly\");\n            break;\n          }\n          this.receiver.onExtension(frame.extendedType, frame.extendedContent, Frames_1.Flags.hasIgnore(frame.flags));\n          return;\n        }\n      default:\n        {\n          errorMessage = \"Unexpected frame type [\".concat(frameType, \"]\");\n          // TODO: throws if strict\n        }\n    }\n\n    this.stream.send({\n      type: Frames_1.FrameTypes.ERROR,\n      flags: Frames_1.Flags.NONE,\n      code: Errors_1.ErrorCodes.CANCELED,\n      message: errorMessage,\n      streamId: this.streamId\n    });\n    this.stream.disconnect(this);\n    this.close(new Errors_1.RSocketError(Errors_1.ErrorCodes.CANCELED, errorMessage));\n  };\n  RequestChannelResponderStream.prototype.onError = function (error) {\n    if (this.outboundDone) {\n      console.warn(\"Trying to error for the second time. \".concat(error ? \"Dropping error [\".concat(error, \"].\") : \"\"));\n      return;\n    }\n    var inboundDone = this.inboundDone;\n    this.outboundDone = true;\n    this.inboundDone = true;\n    this.stream.send({\n      type: Frames_1.FrameTypes.ERROR,\n      flags: Frames_1.Flags.NONE,\n      code: error instanceof Errors_1.RSocketError ? error.code : Errors_1.ErrorCodes.APPLICATION_ERROR,\n      message: error.message,\n      streamId: this.streamId\n    });\n    this.stream.disconnect(this);\n    if (!inboundDone) {\n      if (this.receiver) {\n        this.receiver.onError(error);\n      } else {\n        this.defferedError = error;\n      }\n    }\n  };\n  RequestChannelResponderStream.prototype.onNext = function (payload, isCompletion) {\n    var e_3, _a;\n    if (this.outboundDone) {\n      return;\n    }\n    if (isCompletion) {\n      this.outboundDone = true;\n    }\n    // TODO: add payload size validation\n    if ((0, Fragmenter_1.isFragmentable)(payload, this.fragmentSize, Frames_1.FrameTypes.PAYLOAD)) {\n      try {\n        for (var _b = __values((0, Fragmenter_1.fragment)(this.streamId, payload, this.fragmentSize, Frames_1.FrameTypes.PAYLOAD, isCompletion)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var frame = _c.value;\n          this.stream.send(frame);\n        }\n      } catch (e_3_1) {\n        e_3 = {\n          error: e_3_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_3) throw e_3.error;\n        }\n      }\n    } else {\n      this.stream.send({\n        type: Frames_1.FrameTypes.PAYLOAD,\n        flags: Frames_1.Flags.NEXT | (isCompletion ? Frames_1.Flags.COMPLETE : Frames_1.Flags.NONE) | (payload.metadata ? Frames_1.Flags.METADATA : Frames_1.Flags.NONE),\n        data: payload.data,\n        metadata: payload.metadata,\n        streamId: this.streamId\n      });\n    }\n    if (isCompletion && this.inboundDone) {\n      this.stream.disconnect(this);\n    }\n  };\n  RequestChannelResponderStream.prototype.onComplete = function () {\n    if (this.outboundDone) {\n      return;\n    }\n    this.outboundDone = true;\n    this.stream.send({\n      type: Frames_1.FrameTypes.PAYLOAD,\n      flags: Frames_1.Flags.COMPLETE,\n      streamId: this.streamId,\n      data: null,\n      metadata: null\n    });\n    if (this.inboundDone) {\n      this.stream.disconnect(this);\n    }\n  };\n  RequestChannelResponderStream.prototype.onExtension = function (extendedType, content, canBeIgnored) {\n    if (this.outboundDone && this.inboundDone) {\n      return;\n    }\n    this.stream.send({\n      type: Frames_1.FrameTypes.EXT,\n      streamId: this.streamId,\n      flags: canBeIgnored ? Frames_1.Flags.IGNORE : Frames_1.Flags.NONE,\n      extendedType: extendedType,\n      extendedContent: content\n    });\n  };\n  RequestChannelResponderStream.prototype.request = function (n) {\n    if (this.inboundDone) {\n      return;\n    }\n    this.stream.send({\n      type: Frames_1.FrameTypes.REQUEST_N,\n      flags: Frames_1.Flags.NONE,\n      streamId: this.streamId,\n      requestN: n\n    });\n  };\n  RequestChannelResponderStream.prototype.cancel = function () {\n    if (this.inboundDone) {\n      return;\n    }\n    this.inboundDone = true;\n    this.stream.send({\n      type: Frames_1.FrameTypes.CANCEL,\n      flags: Frames_1.Flags.NONE,\n      streamId: this.streamId\n    });\n    if (this.outboundDone) {\n      this.stream.disconnect(this);\n    }\n  };\n  RequestChannelResponderStream.prototype.close = function (error) {\n    if (this.inboundDone && this.outboundDone) {\n      console.warn(\"Trying to close for the second time. \".concat(error ? \"Dropping error [\".concat(error, \"].\") : \"\"));\n      return;\n    }\n    var inboundDone = this.inboundDone;\n    var outboundDone = this.outboundDone;\n    this.inboundDone = true;\n    this.outboundDone = true;\n    Reassembler.cancel(this);\n    var receiver = this.receiver;\n    if (!receiver) {\n      return;\n    }\n    if (!outboundDone) {\n      receiver.cancel();\n    }\n    if (!inboundDone) {\n      if (error) {\n        receiver.onError(error);\n      } else {\n        receiver.onComplete();\n      }\n    }\n  };\n  return RequestChannelResponderStream;\n}();\nexports.RequestChannelResponderStream = RequestChannelResponderStream;","map":{"version":3,"names":["require","Errors_1","Fragmenter_1","Frames_1","Reassembler","__importStar","RequestChannelRequesterStream","payload","isComplete","receiver","fragmentSize","initialRequestN","leaseManager","streamType","FrameTypes","REQUEST_CHANNEL","prototype","handleReady","streamId","stream","outboundDone","connect","isCompleted","isFragmentable","_b","__values","fragmentWithRequestN","_c","next","done","frame","value","send","type","data","metadata","requestN","flags","undefined","Flags","METADATA","NONE","COMPLETE","hasExtension","EXT","extendedContent","extendedType","handleReject","error","inboundDone","onError","handle","errorMessage","frameType","PAYLOAD","hasComplete","hasNext","hasFollows","disconnect","onComplete","hasFragments","reassemble","onNext","add","CANCEL","cancel","REQUEST_N","concat","request","ERROR","RSocketError","code","message","onExtension","hasIgnore","close","ErrorCodes","CANCELED","n","_a","cancelRequest","fragment","NEXT","APPLICATION_ERROR","content","canBeIgnored","IGNORE","exports","RequestChannelResponderStream","handler","defferedError","console","warn","isCompletion"],"sources":["../src/RequestChannelStream.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}