{"ast":null,"code":"\"use strict\";\n\n/*\n * Copyright 2021-2022 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nrequire(\"core-js/modules/es.array.push.js\");\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.decodeRoutes = exports.encodeRoute = exports.encodeRoutes = exports.RoutingMetadata = void 0;\nvar RoutingMetadata = /** @class */function () {\n  function RoutingMetadata(buffer) {\n    this._buffer = buffer;\n  }\n  RoutingMetadata.prototype.iterator = function () {\n    return decodeRoutes(this._buffer);\n  };\n  RoutingMetadata.prototype[Symbol.iterator] = function () {\n    return decodeRoutes(this._buffer);\n  };\n  return RoutingMetadata;\n}();\nexports.RoutingMetadata = RoutingMetadata;\n/**\n * Encode given set of routes into {@link Buffer} following the <a href=\"https://github.com/rsocket/rsocket/blob/master/Extensions/Routing.md\">Routing Metadata Layout</a>\n *\n * @param routes non-empty set of routes\n * @returns {Buffer} with encoded content\n */\nfunction encodeRoutes() {\n  var routes = [];\n  for (var _i = 0; _i < arguments.length; _i++) {\n    routes[_i] = arguments[_i];\n  }\n  if (routes.length < 1) {\n    throw new Error(\"routes should be non empty array\");\n  }\n  return Buffer.concat(routes.map(function (route) {\n    return encodeRoute(route);\n  }));\n}\nexports.encodeRoutes = encodeRoutes;\nfunction encodeRoute(route) {\n  var encodedRoute = Buffer.from(route, \"utf8\");\n  if (encodedRoute.length > 255) {\n    throw new Error(\"route length should fit into unsigned byte length but the given one is \".concat(encodedRoute.length));\n  }\n  var encodedLength = Buffer.allocUnsafe(1);\n  encodedLength.writeUInt8(encodedRoute.length);\n  return Buffer.concat([encodedLength, encodedRoute]);\n}\nexports.encodeRoute = encodeRoute;\nfunction decodeRoutes(routeMetadataBuffer) {\n  var length, offset, routeLength, route;\n  return __generator(this, function (_a) {\n    switch (_a.label) {\n      case 0:\n        length = routeMetadataBuffer.byteLength;\n        offset = 0;\n        _a.label = 1;\n      case 1:\n        if (!(offset < length)) return [3 /*break*/, 3];\n        routeLength = routeMetadataBuffer.readUInt8(offset++);\n        if (offset + routeLength > length) {\n          throw new Error(\"Malformed RouteMetadata. Offset(\".concat(offset, \") + RouteLength(\").concat(routeLength, \") is greater than TotalLength\"));\n        }\n        route = routeMetadataBuffer.toString(\"utf8\", offset, offset + routeLength);\n        offset += routeLength;\n        return [4 /*yield*/, route];\n      case 2:\n        _a.sent();\n        return [3 /*break*/, 1];\n      case 3:\n        return [2 /*return*/];\n    }\n  });\n}\n\nexports.decodeRoutes = decodeRoutes;","map":{"version":3,"names":["require","RoutingMetadata","buffer","_buffer","prototype","iterator","decodeRoutes","Symbol","exports","encodeRoutes","routes","_i","arguments","length","Error","Buffer","concat","map","route","encodeRoute","encodedRoute","from","encodedLength","allocUnsafe","writeUInt8","routeMetadataBuffer","byteLength","offset","routeLength","readUInt8","toString","_a","sent"],"sources":["../src/RoutingMetadata.ts"],"sourcesContent":[null],"mappings":";;AAAA;;;;;;;;;;;;;;;AAAAA,OAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBA,IAAAC,eAAA;EAGE,SAAAA,gBAAYC,MAAc;IACxB,IAAI,CAACC,OAAO,GAAGD,MAAM;EACvB;EAEAD,eAAA,CAAAG,SAAA,CAAAC,QAAQ,GAAR;IACE,OAAOC,YAAY,CAAC,IAAI,CAACH,OAAO,CAAC;EACnC,CAAC;EAEDF,eAAA,CAAAG,SAAA,CAACG,MAAM,CAACF,QAAQ,CAAC,GAAjB;IACE,OAAOC,YAAY,CAAC,IAAI,CAACH,OAAO,CAAC;EACnC,CAAC;EACH,OAAAF,eAAC;AAAD,CAAC,CAdD;AAAaO,OAAA,CAAAP,eAAA,GAAAA,eAAA;AAgBb;;;;;;AAMA,SAAgBQ,YAAYA,CAAA;EAAC,IAAAC,MAAA;OAAA,IAAAC,EAAA,IAAmB,EAAnBA,EAAA,GAAAC,SAAA,CAAAC,MAAmB,EAAnBF,EAAA,EAAmB;IAAnBD,MAAA,CAAAC,EAAA,IAAAC,SAAA,CAAAD,EAAA;;EAC3B,IAAID,MAAM,CAACG,MAAM,GAAG,CAAC,EAAE;IACrB,MAAM,IAAIC,KAAK,CAAC,kCAAkC,CAAC;;EAGrD,OAAOC,MAAM,CAACC,MAAM,CAACN,MAAM,CAACO,GAAG,CAAC,UAACC,KAAK;IAAK,OAAAC,WAAW,CAACD,KAAK,CAAC;EAAlB,CAAkB,CAAC,CAAC;AACjE;AANAV,OAAA,CAAAC,YAAA,GAAAA,YAAA;AAQA,SAAgBU,WAAWA,CAACD,KAAa;EACvC,IAAME,YAAY,GAAGL,MAAM,CAACM,IAAI,CAACH,KAAK,EAAE,MAAM,CAAC;EAE/C,IAAIE,YAAY,CAACP,MAAM,GAAG,GAAG,EAAE;IAC7B,MAAM,IAAIC,KAAK,CACb,0EAAAE,MAAA,CAA0EI,YAAY,CAACP,MAAM,CAAE,CAChG;;EAGH,IAAMS,aAAa,GAAGP,MAAM,CAACQ,WAAW,CAAC,CAAC,CAAC;EAE3CD,aAAa,CAACE,UAAU,CAACJ,YAAY,CAACP,MAAM,CAAC;EAE7C,OAAOE,MAAM,CAACC,MAAM,CAAC,CAACM,aAAa,EAAEF,YAAY,CAAC,CAAC;AACrD;AAdAZ,OAAA,CAAAW,WAAA,GAAAA,WAAA;AAgBA,SAAiBb,YAAYA,CAC3BmB,mBAA2B;;;;;QAErBZ,MAAM,GAAGY,mBAAmB,CAACC,UAAU;QACzCC,MAAM,GAAG,CAAC;;;cAEPA,MAAM,GAAGd,MAAM;QACde,WAAW,GAAGH,mBAAmB,CAACI,SAAS,CAACF,MAAM,EAAE,CAAC;QAE3D,IAAIA,MAAM,GAAGC,WAAW,GAAGf,MAAM,EAAE;UACjC,MAAM,IAAIC,KAAK,CACb,mCAAAE,MAAA,CAAmCW,MAAM,sBAAAX,MAAA,CAAmBY,WAAW,kCAA+B,CACvG;;QAGGV,KAAK,GAAGO,mBAAmB,CAACK,QAAQ,CACxC,MAAM,EACNH,MAAM,EACNA,MAAM,GAAGC,WAAW,CACrB;QACDD,MAAM,IAAIC,WAAW;QACrB,qBAAMV,KAAK;;QAAXa,EAAA,CAAAC,IAAA,EAAW;;;;;;;;AArBfxB,OAAA,CAAAF,YAAA,GAAAA,YAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}