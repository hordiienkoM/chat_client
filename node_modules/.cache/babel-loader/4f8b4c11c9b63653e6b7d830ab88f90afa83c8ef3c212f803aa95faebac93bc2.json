{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { RSocketClient, JsonSerializer, IdentitySerializer, BufferEncoders } from 'rsocket-core';\nimport RSocketWebSocketClient from 'rsocket-websocket-client';\nconst client = new RSocketClient({\n  serializers: {\n    data: JsonSerializer,\n    metadata: IdentitySerializer\n  },\n  setup: {\n    keepAlive: 60000,\n    lifetime: 180000,\n    dataMimeType: 'application/json',\n    metadataMimeType: 'message/x.rsocket.routing.v0'\n  },\n  transport: new RSocketWebSocketClient({\n    url: 'ws://localhost:8080/rsocket',\n    wsCreator: url => new WebSocket(url)\n  }),\n  encoding: BufferEncoders\n});\nexport async function connect() {\n  return await client.connect();\n}\nexport async function disconnect(rsocket) {\n  await rsocket.close();\n}\nexport async function login(rsocket, username, password) {\n  const metadata = String.fromCharCode(username.length) + username + String.fromCharCode(password.length) + password;\n  await rsocket.fireAndForget({\n    data: null,\n    metadata\n  });\n}\nexport async function requestResponse(rsocket) {\n  const response = await rsocket.requestResponse({\n    data: 'request-response',\n    metadata: null\n  });\n  return response.data;\n}\nexport async function fireAndForget(rsocket) {\n  await rsocket.fireAndForget({\n    data: 'fire-and-forget',\n    metadata: null\n  });\n}\nexport async function stream(rsocket) {\n  const messages = [];\n  await rsocket.requestStream({\n    data: 'stream',\n    metadata: null\n  }).subscribe({\n    onNext: payload => {\n      messages.push(payload.data);\n    }\n  });\n  return messages;\n}\nexport async function channel(rsocket, interval1, interval2, interval3) {\n  const intervals = [interval1, interval2, interval3];\n  const messages = [];\n  const settings = intervals.map(interval => {\n    return rsocket.requestResponse({\n      data: 'channel',\n      metadata: interval.toString()\n    });\n  });\n  await rsocket.requestChannel({\n    data: settings,\n    metadata: null\n  }).subscribe({\n    onNext: payload => {\n      messages.push(payload.data);\n    }\n  });\n  return messages;\n}","map":{"version":3,"names":["RSocketClient","JsonSerializer","IdentitySerializer","BufferEncoders","RSocketWebSocketClient","client","serializers","data","metadata","setup","keepAlive","lifetime","dataMimeType","metadataMimeType","transport","url","wsCreator","WebSocket","encoding","connect","disconnect","rsocket","close","login","username","password","String","fromCharCode","length","fireAndForget","requestResponse","response","stream","messages","requestStream","subscribe","onNext","payload","push","channel","interval1","interval2","interval3","intervals","settings","map","interval","toString","requestChannel"],"sources":["/home/hordiienko/VueProjects/night-chat/src/service/rs-client/rsocket-client.js"],"sourcesContent":["import { RSocketClient, JsonSerializer, IdentitySerializer, BufferEncoders } from 'rsocket-core';\nimport RSocketWebSocketClient from 'rsocket-websocket-client';\n\nconst client = new RSocketClient({\n  serializers: {\n    data: JsonSerializer,\n    metadata: IdentitySerializer,\n  },\n  setup: {\n    keepAlive: 60000,\n    lifetime: 180000,\n    dataMimeType: 'application/json',\n    metadataMimeType: 'message/x.rsocket.routing.v0',\n  },\n  transport: new RSocketWebSocketClient({\n    url: 'ws://localhost:8080/rsocket',\n    wsCreator: (url) => new WebSocket(url),\n  }),\n  encoding: BufferEncoders,\n});\n\nexport async function connect() {\n  return await client.connect();\n}\n\nexport async function disconnect(rsocket) {\n  await rsocket.close();\n}\n\nexport async function login(rsocket, username, password) {\n  const metadata = String.fromCharCode(username.length) + username + String.fromCharCode(password.length) + password;\n  await rsocket.fireAndForget({\n    data: null,\n    metadata,\n  });\n}\n\nexport async function requestResponse(rsocket) {\n  const response = await rsocket.requestResponse({\n    data: 'request-response',\n    metadata: null,\n  });\n  return response.data;\n}\n\nexport async function fireAndForget(rsocket) {\n  await rsocket.fireAndForget({\n    data: 'fire-and-forget',\n    metadata: null,\n  });\n}\n\nexport async function stream(rsocket) {\n  const messages = [];\n  await rsocket.requestStream({\n    data: 'stream',\n    metadata: null,\n  }).subscribe({\n    onNext: (payload) => {\n      messages.push(payload.data);\n    },\n  });\n  return messages;\n}\n\nexport async function channel(rsocket, interval1, interval2, interval3) {\n  const intervals = [interval1, interval2, interval3];\n  const messages = [];\n  const settings = intervals.map((interval) => {\n    return rsocket.requestResponse({\n      data: 'channel',\n      metadata: interval.toString(),\n    });\n  });\n  await rsocket.requestChannel({\n    data: settings,\n    metadata: null,\n  }).subscribe({\n    onNext: (payload) => {\n      messages.push(payload.data);\n    },\n  });\n  return messages;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}